<!DOCTYPE html>
<html lang="en">

<head>
    <title>Patient Dashboard - MediTrack</title>
    <%- include('../../partials/_header') %>
    <%- include('../../partials/_styles') %>
    <!-- Add Bootstrap & FontAwesome CSS -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
<link rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" />

<style>
    /* Paste your CSS provided for .main-content, .dashboard-container, .dashboard-grid, and .dashboard-card here */
</style>

<div class="dashboard-grid">
    <div class="dashboard-grid">
        <div class="dashboard-card" onclick="window.location.href='/refill-alerts'">
            <i class="fas fa-exclamation-triangle"></i>
            <h3>Refill Alerts</h3>
            <p>Medications needing refill soon</p>
            <div class="count"><%= refillAlerts ? refillAlerts.length : 0 %></div>
        </div>
    
        <div class="dashboard-card" onclick="window.location.href='/timely-reminders'">
            <i class="fas fa-bell"></i>
            <h3>Timely Reminders</h3>
            <p>Upcoming medication reminders</p>
            <div class="count"><%= reminders ? reminders.length : 0 %></div>
        </div>
        <!-- Add similar templating for other cards -->
    </div>
    
    <div class="analytics-section">
        <h2>Analytics</h2>
        <div class="analytics-grid">
            <div class="chart-container">
                <h3>Medication Inventory Levels</h3>
                <canvas id="inventoryChart"></canvas>
            </div>
            <div class="chart-container">
                <h3>Reminder Completion Trend</h3>
                <canvas id="completionChart"></canvas>
            </div>
            <div class="chart-container">
                <h3>Medication Types Distribution</h3>
                <canvas id="typesChart"></canvas>
            </div>
        </div>
    </div>
    

    <div class="dashboard-card" onclick="window.location.href='/timely-reminders'">
        <i class="fas fa-bell"></i>
        <h3>Timely Reminders</h3>
        <p>Upcoming medication reminders</p>
        <div class="count"><%= reminders ? reminders.length : 0 %></div>
    </div>
    <!-- Add similar templating for other cards -->
</div>



</head>

<body>
    <%- include('../../partials/_sidebar') %>
    <%- include('../../partials/_auth') %>

    <div class="main-content">
        <div class="dashboard-container">
            <h1>Patient Dashboard</h1>
        </div>
    </div>
</body>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script src="/js/charts/chart.min.js"></script>
<script>
document.addEventListener('DOMContentLoaded', function () {
    const inventoryCtx = document.getElementById('inventoryChart').getContext('2d');
    const completionCtx = document.getElementById('completionChart').getContext('2d');
    const typesCtx = document.getElementById('typesChart').getContext('2d');

    // Medication Inventory Bar Chart
    new Chart(inventoryCtx, {
        type: 'bar',
        data: {
            labels: <%- JSON.stringify(currentMedications ? currentMedications.map(m => m.name) : []) %>,
            datasets: [{
                label: 'Inventory Levels',
                data: <%- JSON.stringify(currentMedications ? currentMedications.map(m => m.inventory) : []) %>,
                backgroundColor: '#3498db',
            }]
        },
        options: { responsive: true }
    });

    // Reminder Completion Trend (Hardcoded)
    new Chart(completionCtx, {
        type: 'line',
        data: {
            labels: ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'],
            datasets: [{ label: 'Reminders', data: [80, 85, 90, 75, 95, 70, 88] }]
        },
    });

    // Medication Types Pie Chart
    new Chart(typesCtx, {
        type: 'pie',
        data: {
            labels: ['Pill', 'Injection', 'Liquid', 'Other'],
            datasets: [{
                data: [10, 5, 2, 3],
                backgroundColor: ['#3498db', '#e74c3c', '#f1c40f', '#9b59b6']
            }]
        },
    });
</script>


</html>
